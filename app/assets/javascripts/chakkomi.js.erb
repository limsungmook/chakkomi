$(function() {
	var History = window.History;


	if ( !History.enabled ){
	    return false;
	}
//	$(".laydesk_sidebar_menu a").click(function(e) {
	$(".ajax_link").click(function(e) {
//		history.pushState(null, document.title, this.href);
		var State = History.getState();
//debug
//		History.log(State.data, State.title, State.url);
//		History.log(State.data, 'clicked', this.href);
		History.pushState(null, document.title, this.href);

		if (this.href != State.url)
		{
		    return false;
		}
	    });

	History.Adapter.bind(window, 'statechange', function(){
		var State = History.getState();
//		alert('state change');
//debug
//		History.log(State.data, State.title, State.url);
//		History.log(State.data, 'getstate', State.url);

		$.getScript(State.url);
	    });
//	$(window).bind("popstate", function() {
//		$.getScript(location.href);
//	    });
});
